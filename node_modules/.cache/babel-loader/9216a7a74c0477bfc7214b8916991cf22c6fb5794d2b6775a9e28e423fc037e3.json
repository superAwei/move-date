{"ast":null,"code":"import { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"user-matching\"\n};\nconst _hoisted_2 = {\n  key: 0\n};\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = {\n  key: 1\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[1] || (_cache[1] = _createElementVNode(\"h2\", null, \"Your Matches\", -1 /* HOISTED */)), $setup.matches.length ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.matches, match => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: match.id,\n      class: \"match-item\"\n    }, [_createElementVNode(\"h3\", null, _toDisplayString(match.email), 1 /* TEXT */), _createElementVNode(\"p\", null, \"Common movie preferences: \" + _toDisplayString(match.commonPreferences.join(', ')), 1 /* TEXT */), _createElementVNode(\"button\", {\n      onClick: $event => $setup.startChat(match.id)\n    }, \"Start Chat\", 8 /* PROPS */, _hoisted_3)]);\n  }), 128 /* KEYED_FRAGMENT */))])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_4, _cache[0] || (_cache[0] = [_createElementVNode(\"p\", null, \"No matches found. Try updating your movie preferences!\", -1 /* HOISTED */)])))]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_hoisted_1","_createElementVNode","$setup","matches","length","_hoisted_2","_Fragment","_renderList","match","id","_toDisplayString","email","commonPreferences","join","onClick","$event","startChat","_hoisted_3","_hoisted_4","_cache"],"sources":["/Users/awei/Desktop/movie dating/src/views/UserMatching.vue"],"sourcesContent":["<template>\n  <div class=\"user-matching\">\n    <h2>Your Matches</h2>\n    <div v-if=\"matches.length\">\n      <div v-for=\"match in matches\" :key=\"match.id\" class=\"match-item\">\n        <h3>{{ match.email }}</h3>\n        <p>Common movie preferences: {{ match.commonPreferences.join(', ') }}</p>\n        <button @click=\"startChat(match.id)\">Start Chat</button>\n      </div>\n    </div>\n    <div v-else>\n      <p>No matches found. Try updating your movie preferences!</p>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, onMounted } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { auth, db } from '@/firebase'\nimport { collection, query, where, getDocs, doc, getDoc } from 'firebase/firestore'\n\nexport default {\n  name: 'UserMatching',\n  setup() {\n    const matches = ref([])\n    const router = useRouter()\n\n    onMounted(async () => {\n      const user = auth.currentUser\n      if (user) {\n        const userDoc = await getDoc(doc(db, 'users', user.uid))\n        const userData = userDoc.data()\n        const userPreferences = userData.moviePreferences || []\n\n        const usersRef = collection(db, 'users')\n        const q = query(usersRef, where('moviePreferences', 'array-contains-any', userPreferences))\n        const querySnapshot = await getDocs(q)\n\n        querySnapshot.forEach((doc) => {\n          if (doc.id !== user.uid) {\n            const matchData = doc.data()\n            const commonPreferences = matchData.moviePreferences.filter(pref => userPreferences.includes(pref))\n            matches.value.push({\n              id: doc.id,\n              email: matchData.email,\n              commonPreferences\n            })\n          }\n        })\n      } else {\n        router.push('/signin')\n      }\n    })\n\n    const startChat = (matchId) => {\n      router.push({ name: 'Chat', params: { id: matchId } })\n    }\n\n    return {\n      matches,\n      startChat\n    }\n  }\n}\n</script>\n"],"mappings":";;EACOA,KAAK,EAAC;AAAe;;EAD5BC,GAAA;AAAA;mBAAA;;EAAAA,GAAA;AAAA;;uBACEC,mBAAA,CAYM,OAZNC,UAYM,G,0BAXJC,mBAAA,CAAqB,YAAjB,cAAY,sBACLC,MAAA,CAAAC,OAAO,CAACC,MAAM,I,cAAzBL,mBAAA,CAMM,OATVM,UAAA,I,kBAIMN,mBAAA,CAIMO,SAAA,QARZC,WAAA,CAI2BL,MAAA,CAAAC,OAAO,EAAhBK,KAAK;yBAAjBT,mBAAA,CAIM;MAJyBD,GAAG,EAAEU,KAAK,CAACC,EAAE;MAAEZ,KAAK,EAAC;QAClDI,mBAAA,CAA0B,YAAAS,gBAAA,CAAnBF,KAAK,CAACG,KAAK,kBAClBV,mBAAA,CAAyE,WAAtE,4BAA0B,GAAAS,gBAAA,CAAGF,KAAK,CAACI,iBAAiB,CAACC,IAAI,wBAC5DZ,mBAAA,CAAwD;MAA/Ca,OAAK,EAAAC,MAAA,IAAEb,MAAA,CAAAc,SAAS,CAACR,KAAK,CAACC,EAAE;OAAG,YAAU,iBAPvDQ,UAAA,E;qDAUIlB,mBAAA,CAEM,OAZVmB,UAAA,EAAAC,MAAA,QAAAA,MAAA,OAWMlB,mBAAA,CAA6D,WAA1D,wDAAsD,oB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}