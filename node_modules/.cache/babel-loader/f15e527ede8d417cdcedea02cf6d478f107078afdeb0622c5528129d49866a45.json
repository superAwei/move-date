{"ast":null,"code":"import { ref, onMounted } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { auth, db } from '@/firebase';\nimport { collection, query, where, getDocs, doc, getDoc } from 'firebase/firestore';\nexport default {\n  name: 'UserMatching',\n  setup() {\n    const matches = ref([]);\n    const router = useRouter();\n    onMounted(async () => {\n      const user = auth.currentUser;\n      if (user) {\n        const userDoc = await getDoc(doc(db, 'users', user.uid));\n        const userData = userDoc.data();\n        const userPreferences = userData.moviePreferences || [];\n        const usersRef = collection(db, 'users');\n        const q = query(usersRef, where('moviePreferences', 'array-contains-any', userPreferences));\n        const querySnapshot = await getDocs(q);\n        querySnapshot.forEach(doc => {\n          if (doc.id !== user.uid) {\n            const matchData = doc.data();\n            const commonPreferences = matchData.moviePreferences.filter(pref => userPreferences.includes(pref));\n            matches.value.push({\n              id: doc.id,\n              email: matchData.email,\n              commonPreferences\n            });\n          }\n        });\n      } else {\n        router.push('/signin');\n      }\n    });\n    const startChat = matchId => {\n      router.push({\n        name: 'Chat',\n        params: {\n          id: matchId\n        }\n      });\n    };\n    return {\n      matches,\n      startChat\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","useRouter","auth","db","collection","query","where","getDocs","doc","getDoc","name","setup","matches","router","user","currentUser","userDoc","uid","userData","data","userPreferences","moviePreferences","usersRef","q","querySnapshot","forEach","id","matchData","commonPreferences","filter","pref","includes","value","push","email","startChat","matchId","params"],"sources":["/Users/awei/Desktop/movie dating/src/views/UserMatching.vue"],"sourcesContent":["<template>\n  <div class=\"user-matching\">\n    <h2>Your Matches</h2>\n    <div v-if=\"matches.length\">\n      <div v-for=\"match in matches\" :key=\"match.id\" class=\"match-item\">\n        <h3>{{ match.email }}</h3>\n        <p>Common movie preferences: {{ match.commonPreferences.join(', ') }}</p>\n        <button @click=\"startChat(match.id)\">Start Chat</button>\n      </div>\n    </div>\n    <div v-else>\n      <p>No matches found. Try updating your movie preferences!</p>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, onMounted } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { auth, db } from '@/firebase'\nimport { collection, query, where, getDocs, doc, getDoc } from 'firebase/firestore'\n\nexport default {\n  name: 'UserMatching',\n  setup() {\n    const matches = ref([])\n    const router = useRouter()\n\n    onMounted(async () => {\n      const user = auth.currentUser\n      if (user) {\n        const userDoc = await getDoc(doc(db, 'users', user.uid))\n        const userData = userDoc.data()\n        const userPreferences = userData.moviePreferences || []\n\n        const usersRef = collection(db, 'users')\n        const q = query(usersRef, where('moviePreferences', 'array-contains-any', userPreferences))\n        const querySnapshot = await getDocs(q)\n\n        querySnapshot.forEach((doc) => {\n          if (doc.id !== user.uid) {\n            const matchData = doc.data()\n            const commonPreferences = matchData.moviePreferences.filter(pref => userPreferences.includes(pref))\n            matches.value.push({\n              id: doc.id,\n              email: matchData.email,\n              commonPreferences\n            })\n          }\n        })\n      } else {\n        router.push('/signin')\n      }\n    })\n\n    const startChat = (matchId) => {\n      router.push({ name: 'Chat', params: { id: matchId } })\n    }\n\n    return {\n      matches,\n      startChat\n    }\n  }\n}\n</script>\n"],"mappings":"AAiBA,SAASA,GAAG,EAAEC,SAAQ,QAAS,KAAI;AACnC,SAASC,SAAQ,QAAS,YAAW;AACrC,SAASC,IAAI,EAAEC,EAAC,QAAS,YAAW;AACpC,SAASC,UAAU,EAAEC,KAAK,EAAEC,KAAK,EAAEC,OAAO,EAAEC,GAAG,EAAEC,MAAK,QAAS,oBAAmB;AAElF,eAAe;EACbC,IAAI,EAAE,cAAc;EACpBC,KAAKA,CAAA,EAAG;IACN,MAAMC,OAAM,GAAIb,GAAG,CAAC,EAAE;IACtB,MAAMc,MAAK,GAAIZ,SAAS,CAAC;IAEzBD,SAAS,CAAC,YAAY;MACpB,MAAMc,IAAG,GAAIZ,IAAI,CAACa,WAAU;MAC5B,IAAID,IAAI,EAAE;QACR,MAAME,OAAM,GAAI,MAAMP,MAAM,CAACD,GAAG,CAACL,EAAE,EAAE,OAAO,EAAEW,IAAI,CAACG,GAAG,CAAC;QACvD,MAAMC,QAAO,GAAIF,OAAO,CAACG,IAAI,CAAC;QAC9B,MAAMC,eAAc,GAAIF,QAAQ,CAACG,gBAAe,IAAK,EAAC;QAEtD,MAAMC,QAAO,GAAIlB,UAAU,CAACD,EAAE,EAAE,OAAO;QACvC,MAAMoB,CAAA,GAAIlB,KAAK,CAACiB,QAAQ,EAAEhB,KAAK,CAAC,kBAAkB,EAAE,oBAAoB,EAAEc,eAAe,CAAC;QAC1F,MAAMI,aAAY,GAAI,MAAMjB,OAAO,CAACgB,CAAC;QAErCC,aAAa,CAACC,OAAO,CAAEjB,GAAG,IAAK;UAC7B,IAAIA,GAAG,CAACkB,EAAC,KAAMZ,IAAI,CAACG,GAAG,EAAE;YACvB,MAAMU,SAAQ,GAAInB,GAAG,CAACW,IAAI,CAAC;YAC3B,MAAMS,iBAAgB,GAAID,SAAS,CAACN,gBAAgB,CAACQ,MAAM,CAACC,IAAG,IAAKV,eAAe,CAACW,QAAQ,CAACD,IAAI,CAAC;YAClGlB,OAAO,CAACoB,KAAK,CAACC,IAAI,CAAC;cACjBP,EAAE,EAAElB,GAAG,CAACkB,EAAE;cACVQ,KAAK,EAAEP,SAAS,CAACO,KAAK;cACtBN;YACF,CAAC;UACH;QACF,CAAC;MACH,OAAO;QACLf,MAAM,CAACoB,IAAI,CAAC,SAAS;MACvB;IACF,CAAC;IAED,MAAME,SAAQ,GAAKC,OAAO,IAAK;MAC7BvB,MAAM,CAACoB,IAAI,CAAC;QAAEvB,IAAI,EAAE,MAAM;QAAE2B,MAAM,EAAE;UAAEX,EAAE,EAAEU;QAAQ;MAAE,CAAC;IACvD;IAEA,OAAO;MACLxB,OAAO;MACPuB;IACF;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}